---
title: "Nearshore Fish Atlas Data Wrangle"
author: "Chris Guo"
date: "2024-05-20"
output: html_document
---

```{r include = FALSE}
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(size = "scriptsize")
```

# Intro

This document was built with R version `r getRversion()`.

Here, I document the steps taken in wrangling the NOAA Nearshore Fish Atlas (NFA). This replaces the separate scripts (named "./FishAtlas\_#\_description.R") and combines them into a single, streamlined R markdown file. These R scripts will be archived in case I need to replicate older methods. Namely, I used to use package 'rgdal' for some steps in the wrangling process but that package stopped being supported ca. Oct 2023 in lieu of package 'sf'.

Link to the NFA can be found here, <https://alaskafisheries.noaa.gov/mapping/sz/>. The entire database can be downloaded as a .csv file, which is what I use here. However, I have additional data files that were either shared with me by NFA contect managers or modified from the NOAA NFA data directory for ease of uploading into R. I try to document these cases in the future.

# Step 1. Wrangling events

The idea with this initial step is to define the scale of our samples. Contributors to the NFA did not define their 'SiteID's and 'EventID's similar to each other, so we'll need to distinguish between SiteID vs EventID.

I define a SiteID as *a unique place in space*, i.e., all samples from the same 'beach' (beach TBD later on). An EventID is *a unique pull of the beach seine*. So there can be single or multiple EventID's associated with a SiteID. Additionally, I introduce a VisitID, which adds a temporal distinction amongst SiteIDs, i.e., *all events from the same beach on the same day*.

## Set up

Load required packages, define directory, set options, source scripts:

```{r}
# Packages
library(tidyverse)
library(lubridate)
library(here)

# Directory
wd = here()
dirs = wd %>% list.files() %>% str_subset(pattern = "^README|^LICENSE|.md$|.Rproj$", negate = TRUE)
for (i in seq_along(dirs)) {
  name = str_replace_all(dirs[i], "^", "dir.")
  path = str_replace_all(dirs[i], "^", str_c(wd, "/"))
  assign(name, path)
  rm(name, path, i)
}

# Options

# Source

```

## Read in data

```{r plots, echo=FALSE}
plot(pressure)
```

## Including Plots

You can also embed plots, for example:

```{r plots, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
